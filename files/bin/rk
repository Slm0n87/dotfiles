#!/bin/bash

function prefix() {
  [ -f Gemfile.lock ] && echo 'bundle exec'
}

function preferred_rake() {
  [ -x bin/rake ] && echo 'bin/rake' || echo 'rake'
}

function rake_command() {
  local cmd=($(prefix) $(preferred_rake) $@)
  echo "${cmd[*]}"
  ${cmd[*]}
}

rake_command "$@"
