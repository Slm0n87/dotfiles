#!/usr/bin/env ruby

require 'pry'

COMMAND = 'knife search node \* -a ipaddress'
REGEX   = /(\S+):\n  ipaddress: (\S+)/
FORMAT  =<<FMT
Host %s
  Hostname %s

FMT

`#{COMMAND}`.tap do |output|
  output.scan(REGEX).tap do |pairs|
    pairs.sort.each do |host, ip|
      puts FORMAT % [host, ip]
    end
  end
end
